/**
 * @license
 * Pixi.JS - v1.0.0
 * Copyright (c) 2012, Mat Groves
 * http://goodboydigital.com/
 *
 * Compiled: 2013-04-06
 *
 * Pixi.JS is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */
/**
 * @author Mat Groves http://matgroves.com/ @Doormat23
 */
/**
@module PIXI
 */
function HEXtoRGB(e){return[(e>>16&255)/255,(e>>8&255)/255,(e&255)/255]}function determineMatrixArrayType(){return PIXI.Matrix=typeof Float32Array!="undefined"?Float32Array:Array,PIXI.Matrix}var PIXI=PIXI||{};PIXI.Point=function(e,t){this.x=e||0,this.y=t||0},PIXI.Point.clone=function(){return new PIXI.Point(this.x,this.y)},PIXI.Point.constructor=PIXI.Point,PIXI.Rectangle=function(e,t,n,r){this.x=e||0,this.y=t||0,this.width=n||0,this.height=r||0},PIXI.Rectangle.clone=function(){return new PIXI.Rectangle(this.x,this.y,this.width,this.height)},PIXI.Rectangle.constructor=PIXI.Rectangle,PIXI.DisplayObject=function(){this.position=new PIXI.Point,this.scale=new PIXI.Point(1,1),this.rotation=0,this.alpha=1,this.visible=!0,this.cacheVisible=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this.color=[],this.worldTransform=PIXI.mat3.create(),this.localTransform=PIXI.mat3.create(),this.dynamic=!0,this._sr=0,this._cr=1,this.renderable=!1,this.interactive=!0},PIXI.DisplayObject.constructor=PIXI.DisplayObject,PIXI.DisplayObject.prototype.updateTransform=function(){this.rotation!=this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var e=this.localTransform,t=this.parent.worldTransform,n=this.worldTransform;e[0]=this._cr*this.scale.x,e[1]=-this._sr*this.scale.y,e[3]=this._sr*this.scale.x,e[4]=this._cr*this.scale.y,e[2]=this.position.x,e[5]=this.position.y;var r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5],f=t[0],l=t[1],c=t[2],h=t[3],p=t[4],d=t[5];n[0]=f*r+l*o,n[1]=f*i+l*u,n[2]=f*s+l*a+c,n[3]=h*r+p*o,n[4]=h*i+p*u,n[5]=h*s+p*a+d,this.worldAlpha=this.alpha*this.parent.worldAlpha},PIXI.DisplayObjectContainer=function(){PIXI.DisplayObject.call(this),this.children=[],this.renderable=!1},PIXI.DisplayObjectContainer.constructor=PIXI.DisplayObjectContainer,PIXI.DisplayObjectContainer.prototype=Object.create(PIXI.DisplayObject.prototype),PIXI.DisplayObjectContainer.prototype.addChild=function(e){e.parent!=undefined&&e.parent.removeChild(e),e.parent=this,e.childIndex=this.children.length,this.children.push(e),this.stage&&this.stage.__addChild(e)},PIXI.DisplayObjectContainer.prototype.addChildAt=function(e,t){if(!(t>=0&&t<=this.children.length))throw new Error(e+" The index "+t+" supplied is out of bounds "+this.children.length);e.parent!=undefined&&e.parent.removeChild(e),t==this.children.length?this.children.push(e):this.children.splice(t,0,e),e.parent=this,e.childIndex=t;var n=this.children.length;for(var r=t;r<n;r++)this.children[r].childIndex=r;this.stage&&this.stage.__addChild(e)},PIXI.DisplayObjectContainer.prototype.removeChild=function(e){var t=this.children.indexOf(e);if(t===-1)throw new Error(e+" The supplied DisplayObject must be a child of the caller "+this);this.stage&&this.stage.__removeChild(e),e.parent=undefined,this.children.splice(t,1);for(var n=t,r=this.children.length;n<r;n++)this.children[n].childIndex-=1},PIXI.DisplayObjectContainer.prototype.updateTransform=function(){if(!this.visible)return;PIXI.DisplayObject.prototype.updateTransform.call(this);for(var e=0,t=this.children.length;e<t;e++)this.children[e].updateTransform()},PIXI.blendModes={},PIXI.blendModes.NORMAL=0,PIXI.blendModes.SCREEN=1,PIXI.Sprite=function(e){PIXI.DisplayObjectContainer.call(this),this.anchor=new PIXI.Point,this.texture=e,this.blendMode=PIXI.blendModes.NORMAL,this.width=1,this.height=1,e.baseTexture.hasLoaded?(this.width=this.texture.frame.width,this.height=this.texture.frame.height,this.updateFrame=!0):(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0,this.interactive=!1},PIXI.Sprite.constructor=PIXI.Sprite,PIXI.Sprite.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),PIXI.Sprite.prototype.setTexture=function(e){this.texture.baseTexture!=e.baseTexture&&(this.textureChange=!0),this.texture=e,this.width=e.frame.width,this.height=e.frame.height,this.updateFrame=!0},PIXI.Sprite.prototype.setInteractive=function(e){this.interactive=e,this.stage&&(this.stage.dirty=!0)},PIXI.Sprite.prototype.onTextureUpdate=function(e){this.width=this.texture.frame.width,this.height=this.texture.frame.height,this.updateFrame=!0},PIXI.Sprite.fromFrame=function(e){var t=PIXI.TextureCache[e];if(!t)throw new Error("The frameId '"+e+"' does not exist in the texture cache"+this);return new PIXI.Sprite(t)},PIXI.Sprite.fromImage=function(e){var t=PIXI.Texture.fromImage(e);return new PIXI.Sprite(t)},PIXI.MovieClip=function(e){PIXI.Sprite.call(this,e[0]),this.textures=e,this.currentFrame=0,this.animationSpeed=1,this.playing},PIXI.MovieClip.constructor=PIXI.MovieClip,PIXI.MovieClip.prototype=Object.create(PIXI.Sprite.prototype),PIXI.MovieClip.prototype.stop=function(){this.playing=!1},PIXI.MovieClip.prototype.play=function(){this.playing=!0},PIXI.MovieClip.prototype.gotoAndStop=function(e){this.playing=!1,this.currentFrame=e;var t=this.currentFrame+.5|0;this.setTexture(this.textures[t%this.textures.length])},PIXI.MovieClip.prototype.gotoAndPlay=function(e){this.currentFrame=e,this.playing=!0},PIXI.MovieClip.prototype.updateTransform=function(){PIXI.Sprite.prototype.updateTransform.call(this);if(!this.playing)return;this.currentFrame+=this.animationSpeed;var e=this.currentFrame+.5|0;this.setTexture(this.textures[e%this.textures.length])},PIXI.InteractionManager=function(e){this.stage=e,this.tempPoint=new PIXI.Point,this.mouseoverEnabled=!0,this.mouse=new PIXI.InteractionData,this.touchs={},this.pool=[],this.interactiveItems=[]},PIXI.InteractionManager.constructor=PIXI.InteractionManager,PIXI.InteractionManager.prototype.disableMouseOver=function(){if(!this.mouseoverEnabled)return;this.mouseoverEnabled=!1,this.target&&this.target.view.removeEventListener("mousemove",this.onMouseMove.bind(this))},PIXI.InteractionManager.prototype.enableMouseOver=function(){if(this.mouseoverEnabled)return;this.mouseoverEnabled=!1,this.target&&this.target.view.addEventListener("mousemove",this.onMouseMove.bind(this))},PIXI.InteractionManager.prototype.collectInteractiveSprite=function(e){var t=e.children,n=t.length;for(var r=n-1;r>=0;r--){var i=t[r];if(i instanceof PIXI.Sprite)i.interactive&&this.interactiveItems.push(i);else if(!i.interactive)continue;i.children.length>0&&this.collectInteractiveSprite(i)}},PIXI.InteractionManager.prototype.setTarget=function(e){this.target=e,this.mouseoverEnabled&&e.view.addEventListener("mousemove",this.onMouseMove.bind(this),!0),e.view.addEventListener("mousedown",this.onMouseDown.bind(this),!0),e.view.addEventListener("mouseup",this.onMouseUp.bind(this),!0),e.view.addEventListener("mouseout",this.onMouseUp.bind(this),!0),e.view.addEventListener("touchstart",this.onTouchStart.bind(this),!0),e.view.addEventListener("touchend",this.onTouchEnd.bind(this),!0),e.view.addEventListener("touchmove",this.onTouchMove.bind(this),!0)},PIXI.InteractionManager.prototype.hitTest=function(e){this.dirty&&(this.dirty=!1,this.interactiveItems=[],this.collectInteractiveSprite(this.stage));var t=this.tempPoint,n=this.tempMatrix,r=e.global,i=this.interactiveItems.length;for(var s=0;s<i;s++){var o=this.interactiveItems[s];if(!o.visible)continue;var u=o.worldTransform,a=u[0],f=u[1],l=u[2],c=u[3],h=u[4],p=u[5],d=1/(a*h+f*-c);t.x=h*d*r.x+ -f*d*r.y+(p*f-l*h)*d,t.y=a*d*r.y+ -c*d*r.x+(-p*a+l*c)*d;var v=-o.width*o.anchor.x;if(t.x>v&&t.x<v+o.width){var m=-o.height*o.anchor.y;if(t.y>m&&t.y<m+o.height)return e.local.x=t.x,e.local.y=t.y,o}}return null},PIXI.InteractionManager.prototype.onMouseMove=function(e){e.preventDefault();var t=this.target.view.getBoundingClientRect();this.mouse.global.x=(e.clientX-t.left)*(this.target.width/t.width),this.mouse.global.y=(e.clientY-t.top)*(this.target.height/t.height);var n=this.hitTest(this.mouse);this.currentOver!=n&&(this.currentOver&&(this.mouse.target=this.currentOver,this.currentOver.mouseout&&this.currentOver.mouseout(this.mouse),this.currentOver=null),this.target.view.style.cursor="default");if(n){if(this.currentOver==n)return;this.currentOver=n,this.target.view.style.cursor="pointer",this.mouse.target=n,n.mouseover&&n.mouseover(this.mouse)}},PIXI.InteractionManager.prototype.onMouseDown=function(e){var t=this.target.view.getBoundingClientRect();this.mouse.global.x=(e.clientX-t.left)*(this.target.width/t.width),this.mouse.global.y=(e.clientY-t.top)*(this.target.height/t.height);var n=this.hitTest(this.mouse);n&&(this.currentDown=n,this.mouse.target=n,n.mousedown&&n.mousedown(this.mouse))},PIXI.InteractionManager.prototype.onMouseUp=function(e){this.currentOver&&(this.mouse.target=this.currentOver,this.currentOver.mouseup&&this.currentOver.mouseup(this.mouse)),this.currentDown&&(this.mouse.target=this.currentDown,this.currentOver==this.currentDown&&this.currentDown.click&&this.currentDown.click(this.mouse),this.currentDown=null)},PIXI.InteractionManager.prototype.onTouchMove=function(e){e.preventDefault();var t=this.target.view.getBoundingClientRect(),n=e.changedTouches;for(var r=0;r<n.length;r++){var i=n[r],s=this.touchs[i.identifier];s.global.x=(i.clientX-t.left)*(this.target.width/t.width),s.global.y=(i.clientY-t.top)*(this.target.height/t.height)}},PIXI.InteractionManager.prototype.onTouchStart=function(e){e.preventDefault();var t=this.target.view.getBoundingClientRect(),n=e.changedTouches;for(var r=0;r<n.length;r++){var i=n[r],s=this.pool.pop();s||(s=new PIXI.InteractionData),this.touchs[i.identifier]=s,s.global.x=(i.clientX-t.left)*(this.target.width/t.width),s.global.y=(i.clientY-t.top)*(this.target.height/t.height);var o=this.hitTest(s);o&&(s.currentDown=o,s.target=o,o.touchstart&&o.touchstart(s))}},PIXI.InteractionManager.prototype.onTouchEnd=function(e){e.preventDefault();var t=this.target.view.getBoundingClientRect(),n=e.changedTouches;for(var r=0;r<n.length;r++){var i=n[r],s=this.touchs[i.identifier];s.global.x=(i.clientX-t.left)*(this.target.width/t.width),s.global.y=(i.clientY-t.top)*(this.target.height/t.height);if(s.currentDown){s.currentDown.touchend&&s.currentDown.touchend(s);var o=this.hitTest(s);o==s.currentDown&&s.currentDown.tap&&s.currentDown.tap(s),s.currentDown=null}this.pool.push(s),this.touchs[i.identifier]=null}},PIXI.InteractionData=function(){this.global=new PIXI.Point,this.local=new PIXI.Point,this.target},PIXI.InteractionData.constructor=PIXI.InteractionData,PIXI.Stage=function(e,t){PIXI.DisplayObjectContainer.call(this),this.worldTransform=PIXI.mat3.create(),this.__childrenAdded=[],this.__childrenRemoved=[],this.childIndex=0,this.stage=this,this.interactive=!!t,this.interactionManager=new PIXI.InteractionManager(this),this.setBackgroundColor(e)},PIXI.Stage.constructor=PIXI.Stage,PIXI.Stage.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),PIXI.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var e=0,t=this.children.length;e<t;e++)this.children[e].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0)},PIXI.Stage.prototype.setBackgroundColor=function(e){this.backgroundColor=e||0,this.backgroundColorSplit=HEXtoRGB(this.backgroundColor),this.backgroundColorString="#"+this.backgroundColor.toString(16)},PIXI.Stage.prototype.__addChild=function(e){e.interactive&&(this.dirty=!0),e.stage=this;if(e.children)for(var t=0;t<e.children.length;t++)this.__addChild(e.children[t])},PIXI.Stage.prototype.__removeChild=function(e){e.interactive&&(this.dirty=!0),this.__childrenRemoved.push(e),e.stage=undefined;if(e.children)for(var t=0,n=e.children.length;t<n;t++)this.__removeChild(e.children[t])},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}(),typeof Function.prototype.bind!="function"&&(Function.prototype.bind=function(){var e=Array.prototype.slice;return function(t){function i(){var s=r.concat(e.call(arguments));n.apply(this instanceof i?this:t,s)}var n=this,r=e.call(arguments,1);if(typeof n!="function")throw new TypeError;return i.prototype=function s(e){e&&(s.prototype=e);if(!(this instanceof s))return new s}(n.prototype),i}}());var AjaxRequest=function(){var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new XMLHttpRequest:!1;for(var t=0;t<e.length;t++)try{return new ActiveXObject(e[t])}catch(n){}};PIXI.EventTarget=function(){var e={};this.addEventListener=this.on=function(t,n){e[t]===undefined&&(e[t]=[]),e[t].indexOf(n)===-1&&e[t].push(n)},this.dispatchEvent=this.emit=function(t){for(var n in e[t.type])e[t.type][n](t)},this.removeEventListener=this.off=function(t,n){var r=e[t].indexOf(n);r!==-1&&e[t].splice(r,1)}},determineMatrixArrayType(),PIXI.mat3={},PIXI.mat3.create=function(){var e=new PIXI.Matrix(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},PIXI.mat4={},PIXI.mat4.create=function(){var e=new PIXI.Matrix(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},PIXI.mat3.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5],f=e[6],l=e[7],c=e[8],h=t[0],p=t[1],d=t[2],v=t[3],m=t[4],g=t[5],y=t[6],b=t[7],w=t[8];return n[0]=h*r+p*o+d*f,n[1]=h*i+p*u+d*l,n[2]=h*s+p*a+d*c,n[3]=v*r+m*o+g*f,n[4]=v*i+m*u+g*l,n[5]=v*s+m*a+g*c,n[6]=y*r+b*o+w*f,n[7]=y*i+b*u+w*l,n[8]=y*s+b*a+w*c,n},PIXI.mat3.toMat4=function(e,t){return t||(t=PIXI.mat4.create()),t[15]=1,t[14]=0,t[13]=0,t[12]=0,t[11]=0,t[10]=e[8],t[9]=e[7],t[8]=e[6],t[7]=0,t[6]=e[5],t[5]=e[4],t[4]=e[3],t[3]=0,t[2]=e[2],t[1]=e[1],t[0]=e[0],t},PIXI.mat4.create=function(){var e=new PIXI.Matrix(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},PIXI.mat4.transpose=function(e,t){if(!t||e===t){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],u=e[11];return e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=n,e[6]=e[9],e[7]=e[13],e[8]=r,e[9]=s,e[11]=e[14],e[12]=i,e[13]=o,e[14]=u,e}return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},PIXI.mat4.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5],f=e[6],l=e[7],c=e[8],h=e[9],p=e[10],d=e[11],v=e[12],m=e[13],g=e[14],y=e[15],b=t[0],w=t[1],E=t[2],S=t[3];return n[0]=b*r+w*u+E*c+S*v,n[1]=b*i+w*a+E*h+S*m,n[2]=b*s+w*f+E*p+S*g,n[3]=b*o+w*l+E*d+S*y,b=t[4],w=t[5],E=t[6],S=t[7],n[4]=b*r+w*u+E*c+S*v,n[5]=b*i+w*a+E*h+S*m,n[6]=b*s+w*f+E*p+S*g,n[7]=b*o+w*l+E*d+S*y,b=t[8],w=t[9],E=t[10],S=t[11],n[8]=b*r+w*u+E*c+S*v,n[9]=b*i+w*a+E*h+S*m,n[10]=b*s+w*f+E*p+S*g,n[11]=b*o+w*l+E*d+S*y,b=t[12],w=t[13],E=t[14],S=t[15],n[12]=b*r+w*u+E*c+S*v,n[13]=b*i+w*a+E*h+S*m,n[14]=b*s+w*f+E*p+S*g,n[15]=b*o+w*l+E*d+S*y,n},PIXI.autoDetectRenderer=function(e,t,n,r){e||(e=800),t||(t=600);var i=function(){try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(e){return!1}}();return i?new PIXI.WebGLRenderer(e,t,n,r):new PIXI.CanvasRenderer(e,t,n,r)},PIXI.shaderFragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","gl_FragColor = gl_FragColor * vColor;","}"],PIXI.shaderVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform mat4 uMVMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void) {","gl_Position = uMVMatrix * vec4(aVertexPosition, 1.0, 1.0);","vTextureCoord = aTextureCoord;","vColor = aColor;","}"],PIXI.CompileVertexShader=function(e,t){var n="";for(var r=0;r<t.length;r++)n+=t[r];var i;return i=e.createShader(e.VERTEX_SHADER),e.shaderSource(i,n),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(alert(e.getShaderInfoLog(i)),null)},PIXI.CompileFragmentShader=function(e,t){var n="";for(var r=0;r<t.length;r++)n+=t[r];var i;return i=e.createShader(e.FRAGMENT_SHADER),e.shaderSource(i,n),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(alert(e.getShaderInfoLog(i)),null)},PIXI._defaultFrame=new PIXI.Rectangle(0,0,1,1),PIXI.WebGLRenderer=function(e,t,n,r){this.transparent=!!r,this.width=e||800,this.height=t||600,this.view=n||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height;var i=this;this.view.addEventListener("webglcontextlost",function(e){i.handleContextLost(e)},!1),this.view.addEventListener("webglcontextrestored",function(e){i.handleContextRestored(e)},!1),this.batchs=[];try{this.gl=this.view.getContext("experimental-webgl",{alpha:this.transparent,antialias:!1,premultipliedAlpha:!1})}catch(s){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}this.initShaders();var o=this.gl;this.batch=new PIXI.WebGLBatch(o),o.disable(o.DEPTH_TEST),o.enable(o.BLEND),o.colorMask(!0,!0,!0,this.transparent),this.projectionMatrix=PIXI.mat4.create(),this.resize(this.width,this.height),this.contextLost=!1},PIXI.WebGLRenderer.constructor=PIXI.WebGLRenderer,PIXI.WebGLRenderer.prototype.initShaders=function(){var e=this.gl,t=PIXI.CompileFragmentShader(e,PIXI.shaderFragmentSrc),n=PIXI.CompileVertexShader(e,PIXI.shaderVertexSrc);this.shaderProgram=e.createProgram();var r=this.shaderProgram;e.attachShader(r,n),e.attachShader(r,t),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS)||alert("Could not initialise shaders"),e.useProgram(r),r.vertexPositionAttribute=e.getAttribLocation(r,"aVertexPosition"),e.enableVertexAttribArray(r.vertexPositionAttribute),r.textureCoordAttribute=e.getAttribLocation(r,"aTextureCoord"),e.enableVertexAttribArray(r.textureCoordAttribute),r.colorAttribute=e.getAttribLocation(r,"aColor"),e.enableVertexAttribArray(r.colorAttribute),r.mvMatrixUniform=e.getUniformLocation(r,"uMVMatrix"),r.samplerUniform=e.getUniformLocation(r,"uSampler"),PIXI.shaderProgram=this.shaderProgram},PIXI.WebGLRenderer.prototype.checkVisibility=function(e,t){var n=e.children;for(var r=0;r<n.length;r++){var i=n[r],s=i.visible&&t;i.textureChange&&(i.textureChange=!1,s&&(this.removeDisplayObject(i),this.addDisplayObject(i))),i.cacheVisible!=s&&(i.cacheVisible=s,i.cacheVisible?this.addDisplayObject(i):this.removeDisplayObject(i)),i.children.length>0&&this.checkVisibility(i,s)}},PIXI.WebGLRenderer.prototype.render=function(e){if(this.contextLost)return;for(var t=0;t<e.__childrenRemoved.length;t++)this.removeDisplayObject(e.__childrenRemoved[t]);for(var t=0;t<PIXI.texturesToUpdate.length;t++)this.updateTexture(PIXI.texturesToUpdate[t]);e.__childrenRemoved=[],e.__childrenAdded=[],PIXI.texturesToUpdate=[],this.checkVisibility(e,!0),e.updateTransform();var n=this.gl;n.clear(n.COLOR_BUFFER_BIT),n.clearColor(e.backgroundColorSplit[0],e.backgroundColorSplit[1],e.backgroundColorSplit[2],0),n.blendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA),n.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,this.projectionMatrix);var r;for(var t=0;t<this.batchs.length;t++)r=this.batchs[t],r instanceof PIXI.WebGLBatch?this.batchs[t].render():r instanceof PIXI.Strip&&r.visible&&this.renderStrip(r);e.interactive&&(e._interactiveEventsAdded||(e._interactiveEventsAdded=!0,e.interactionManager.setTarget(this)))},PIXI.WebGLRenderer.prototype.updateTexture=function(e){var t=this.gl;e._glTexture||(e._glTexture=t.createTexture()),e.hasLoaded&&(t.bindTexture(t.TEXTURE_2D,e._glTexture),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e.source),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_2D,null)),this.refreshBatchs=!0},PIXI.WebGLRenderer.prototype.addDisplayObject=function(e){if(!e.stage)return;if(e.__inWebGL)return;e.batch=null;if(!e.renderable)return;e.__inWebGL=!0;var t=e;do{if(t.childIndex==0)t=t.parent;else{t=t.parent.children[t.childIndex-1];while(t.children.length!=0)t=t.children[t.children.length-1]}if(t==e.stage)break}while(!t.renderable||!t.__inWebGL);var n=e;do{if(n.children.length==0){while(n.childIndex==n.parent.children.length-1){n=n.parent;if(n==e.stage){n=null;break}}n&&(n=n.parent.children[n.childIndex+1])}else n=n.children[0];if(!n)break}while(!n.renderable||!n.__inWebGL);if(e instanceof PIXI.Sprite){var r,i;if(t instanceof PIXI.Sprite){r=t.batch;if(r&&r.texture==e.texture.baseTexture&&r.blendMode==e.blendMode){r.insertAfter(e,t);return}}else r=t;if(n)if(n instanceof PIXI.Sprite){i=n.batch;if(i){if(i.texture==e.texture.baseTexture&&i.blendMode==e.blendMode){i.insertBefore(e,n);return}if(i==r){var s=r.split(n),o=PIXI._getBatch(this.gl),u=this.batchs.indexOf(r);o.init(e),this.batchs.splice(u+1,0,o,s);return}}}else i=n;var o=PIXI._getBatch(this.gl);o.init(e);if(r){var u=this.batchs.indexOf(r);this.batchs.splice(u+1,0,o)}else this.batchs.push(o)}else e instanceof PIXI.Strip&&(this.initStrip(e),this.batchs.push(e));this.batchUpdate=!0},PIXI.WebGLRenderer.prototype.removeDisplayObject=function(e){e.cacheVisible=!1;if(!e.renderable)return;e.__inWebGL=!1;var t;if(e instanceof PIXI.Sprite){var n=e.batch;if(!n)return;n.remove(e),n.size==0&&(t=n)}else t=e;if(t){var r=this.batchs.indexOf(t);if(r==-1)return;if(r==0||r==this.batchs.length-1){this.batchs.splice(r,1),t instanceof PIXI.WebGLBatch&&PIXI._returnBatch(t);return}if(this.batchs[r-1]instanceof PIXI.WebGLBatch&&this.batchs[r+1]instanceof PIXI.WebGLBatch&&this.batchs[r-1].texture==this.batchs[r+1].texture&&this.batchs[r-1].blendMode==this.batchs[r+1].blendMode){this.batchs[r-1].merge(this.batchs[r+1]),t instanceof PIXI.WebGLBatch&&PIXI._returnBatch(t),PIXI._returnBatch(this.batchs[r+1]),this.batchs.splice(r,2);return}this.batchs.splice(r,1),t instanceof PIXI.WebGLBatch&&PIXI._returnBatch(t)}},PIXI.WebGLRenderer.prototype.resize=function(e,t){this.width=e,this.height=t,this.view.width=e,this.view.height=t,this.gl.viewport(0,0,this.width,this.height);var n=this.projectionMatrix;n[0]=2/this.width,n[5]=-2/this.height,n[12]=-1,n[13]=1},PIXI.WebGLRenderer.prototype.initStrip=function(e){var t=this.gl,n=this.shaderProgram;e._vertexBuffer=t.createBuffer(),e._indexBuffer=t.createBuffer(),e._uvBuffer=t.createBuffer(),e._colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,e._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,e.verticies,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,e._uvBuffer),t.bufferData(t.ARRAY_BUFFER,e.uvs,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,e._colorBuffer),t.bufferData(t.ARRAY_BUFFER,e.colors,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e.indices,t.STATIC_DRAW)},PIXI.WebGLRenderer.prototype.renderStrip=function(e){var t=this.gl,n=this.shaderProgram,r=PIXI.mat3.toMat4(e.worldTransform);PIXI.mat4.transpose(r),PIXI.mat4.multiply(this.projectionMatrix,r,r),t.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,r),e.blendMode==PIXI.blendModes.NORMAL?t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA):t.blendFunc(t.ONE,t.ONE_MINUS_SRC_COLOR),e.dirty?(e.dirty=!1,t.bindBuffer(t.ARRAY_BUFFER,e._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,e.verticies,t.STATIC_DRAW),t.vertexAttribPointer(n.vertexPositionAttribute,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e._uvBuffer),t.bufferData(t.ARRAY_BUFFER,e.uvs,t.STATIC_DRAW),t.vertexAttribPointer(n.textureCoordAttribute,2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e.texture.baseTexture._glTexture),t.bindBuffer(t.ARRAY_BUFFER,e._colorBuffer),t.bufferData(t.ARRAY_BUFFER,e.colors,t.STATIC_DRAW),t.vertexAttribPointer(n.colorAttribute,1,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e.indices,t.STATIC_DRAW)):(t.bindBuffer(t.ARRAY_BUFFER,e._vertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,e.verticies),t.vertexAttribPointer(n.vertexPositionAttribute,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e._uvBuffer),t.vertexAttribPointer(n.textureCoordAttribute,2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e.texture.baseTexture._glTexture),t.bindBuffer(t.ARRAY_BUFFER,e._colorBuffer),t.vertexAttribPointer(n.colorAttribute,1,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e._indexBuffer)),t.drawElements(t.TRIANGLE_STRIP,e.indices.length,t.UNSIGNED_SHORT,0),t.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,this.projectionMatrix)},PIXI.WebGLRenderer.prototype.handleContextLost=function(e){e.preventDefault(),this.contextLost=!0},PIXI.WebGLRenderer.prototype.handleContextRestored=function(e){this.gl=this.view.getContext("experimental-webgl",{alpha:!0}),this.initShaders();for(var t=0;t<PIXI.TextureCache.length;t++)this.updateTexture(PIXI.TextureCache[t]);for(var t=0;t<this.batchs.length;t++)this.batchs[t].restoreLostContext(this.gl),this.batchs[t].dirty=!0;PIXI._restoreBatchs(this.gl),this.contextLost=!1},PIXI._batchs=[],PIXI._getBatch=function(e){return PIXI._batchs.length==0?new PIXI.WebGLBatch(e):PIXI._batchs.pop()},PIXI._returnBatch=function(e){e.clean(),PIXI._batchs.push(e)},PIXI._restoreBatchs=function(e){for(var t=0;t<PIXI._batchs.length;t++)PIXI._batchs[t].restoreLostContext(e)},PIXI.WebGLBatch=function(e){this.gl=e,this.size=0,this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.uvBuffer=e.createBuffer(),this.colorBuffer=e.createBuffer(),this.blendMode=PIXI.blendModes.NORMAL,this.dynamicSize=1},PIXI.WebGLBatch.constructor=PIXI.WebGLBatch,PIXI.WebGLBatch.prototype.clean=function(){this.verticies=[],this.uvs=[],this.indices=[],this.colors=[],this.dynamicSize=1,this.texture=null,this.last=null,this.size=0,this.head,this.tail},PIXI.WebGLBatch.prototype.restoreLostContext=function(e){this.gl=e,this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.uvBuffer=e.createBuffer(),this.colorBuffer=e.createBuffer()},PIXI.WebGLBatch.prototype.init=function(e){e.batch=this,this.dirty=!0,this.blendMode=e.blendMode,this.texture=e.texture.baseTexture,this.head=e,this.tail=e,this.size=1,this.growBatch()},PIXI.WebGLBatch.prototype.insertBefore=function(e,t){this.size++,e.batch=this,this.dirty=!0;var n=t.__prev;t.__prev=e,e.__next=t,n?(e.__prev=n,n.__next=e):this.head=e},PIXI.WebGLBatch.prototype.insertAfter=function(e,t){this.size++,e.batch=this,this.dirty=!0;var n=t.__next;t.__next=e,e.__prev=t,n?(e.__next=n,n.__prev=e):this.tail=e},PIXI.WebGLBatch.prototype.remove=function(e){this.size--;if(this.size==0){e.batch=null,e.__prev=null,e.__next=null;return}e.__prev?e.__prev.__next=e.__next:(this.head=e.__next,this.head.__prev=null),e.__next?e.__next.__prev=e.__prev:(this.tail=e.__prev,this.tail.__next=null),e.batch=null,e.__next=null,e.__prev=null,this.dirty=!0},PIXI.WebGLBatch.prototype.split=function(e){this.dirty=!0;var t=new PIXI.WebGLBatch(this.gl);t.init(e),t.tail=this.tail,this.tail=e.__prev,this.tail.__next=null,e.__prev=null;var n=0;while(e)n++,e.batch=t,e=e.__next;return t.size=n,this.size-=n,t},PIXI.WebGLBatch.prototype.merge=function(e){this.dirty=!0,this.tail.__next=e.head,e.head.__prev=this.tail,this.size+=e.size,this.tail=e.tail;var t=e.head;while(t)t.batch=this,t=t.__next},PIXI.WebGLBatch.prototype.growBatch=function(){var e=this.gl;this.size==1?this.dynamicSize=1:this.dynamicSize=this.size*1.5,this.verticies=new Float32Array(this.dynamicSize*8),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.verticies,e.DYNAMIC_DRAW),this.uvs=new Float32Array(this.dynamicSize*8),e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer),e.bufferData(e.ARRAY_BUFFER,this.uvs,e.DYNAMIC_DRAW),this.dirtyUVS=!0,this.colors=new Float32Array(this.dynamicSize*4),e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colors,e.DYNAMIC_DRAW),this.dirtyColors=!0,this.indices=new Uint16Array(this.dynamicSize*6);var t=this.indices.length/6;for(var n=0;n<t;n++){var r=n*6,i=n*4;this.indices[r+0]=i+0,this.indices[r+1]=i+1,this.indices[r+2]=i+2,this.indices[r+3]=i+0,this.indices[r+4]=i+2,this.indices[r+5]=i+3}e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW)},PIXI.WebGLBatch.prototype.refresh=function(){var e=this.gl;this.dynamicSize<this.size&&this.growBatch();var t=0,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y=this.head;while(y){c=t*8;var b=y.texture,w=b.frame,E=b.baseTexture.width,S=b.baseTexture.height;this.uvs[c+0]=w.x/E,this.uvs[c+1]=w.y/S,this.uvs[c+2]=(w.x+w.width)/E,this.uvs[c+3]=w.y/S,this.uvs[c+4]=(w.x+w.width)/E,this.uvs[c+5]=(w.y+w.height)/S,this.uvs[c+6]=w.x/E,this.uvs[c+7]=(w.y+w.height)/S,y.updateFrame=!1,colorIndex=t*4,this.colors[colorIndex]=this.colors[colorIndex+1]=this.colors[colorIndex+2]=this.colors[colorIndex+3]=y.worldAlpha,y=y.__next,t++}this.dirtyUVS=!0,this.dirtyColors=!0},PIXI.WebGLBatch.prototype.update=function(){var e=this.gl,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=0,w=this.head;while(w){n=w.width,r=w.height,i=w.anchor.x-w.texture.trim.x,s=w.anchor.y-w.texture.trim.y,o=n*(1-i),u=n*-i,a=r*(1-s),f=r*-s,l=b*8,t=w.worldTransform,p=t[0],d=t[3],v=t[1],m=t[4],g=t[2],y=t[5],this.verticies[l+0]=p*u+v*f+g,this.verticies[l+1]=m*f+d*u+y,this.verticies[l+2]=p*o+v*f+g,this.verticies[l+3]=m*f+d*o+y,this.verticies[l+4]=p*o+v*a+g,this.verticies[l+5]=m*a+d*o+y,this.verticies[l+6]=p*u+v*a+g,this.verticies[l+7]=m*a+d*u+y;if(w.updateFrame){this.dirtyUVS=!0;var E=w.texture,S=E.frame,x=E.baseTexture.width,T=E.baseTexture.height;this.uvs[l+0]=S.x/x,this.uvs[l+1]=S.y/T,this.uvs[l+2]=(S.x+S.width)/x,this.uvs[l+3]=S.y/T,this.uvs[l+4]=(S.x+S.width)/x,this.uvs[l+5]=(S.y+S.height)/T,this.uvs[l+6]=S.x/x,this.uvs[l+7]=(S.y+S.height)/T,w.updateFrame=!1}if(w.cacheAlpha!=w.worldAlpha){w.cacheAlpha=w.worldAlpha;var N=b*4;this.colors[N]=this.colors[N+1]=this.colors[N+2]=this.colors[N+3]=w.worldAlpha,this.dirtyColors=!0}b++,w=w.__next}},PIXI.WebGLBatch.prototype.render=function(){this.dirty&&(this.refresh(),this.dirty=!1);if(this.size==0)return;this.update();var e=this.gl;this.blendMode==PIXI.blendModes.NORMAL?e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA):e.blendFunc(e.ONE,e.ONE_MINUS_SRC_COLOR);var t=PIXI.shaderProgram;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this.verticies),e.vertexAttribPointer(t.vertexPositionAttribute,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer),this.dirtyUVS&&(this.dirtyUVS=!1,e.bufferSubData(e.ARRAY_BUFFER,0,this.uvs)),e.vertexAttribPointer(t.textureCoordAttribute,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.texture._glTexture),e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),this.dirtyColors&&(this.dirtyColors=!1,e.bufferSubData(e.ARRAY_BUFFER,0,this.colors)),e.vertexAttribPointer(t.colorAttribute,1,e.FLOAT,!1,0,0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.drawElements(e.TRIANGLES,this.size*6,e.UNSIGNED_SHORT,0)},PIXI.CanvasRenderer=function(e,t,n,r){this.transparent=r,this.width=e||800,this.height=t||600,this.refresh=!0,this.view=n||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height,this.count=0,this.context=this.view.getContext("2d")},PIXI.CanvasRenderer.constructor=PIXI.CanvasRenderer,PIXI.CanvasRenderer.prototype.render=function(e){e.__childrenAdded=[],e.__childrenRemoved=[],PIXI.texturesToUpdate=[],this.context.setTransform(1,0,0,1,0,0),e.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.view.style.backgroundColor!=e.backgroundColorString&&!this.transparent&&(this.view.style.backgroundColor=e.backgroundColorString),this.context.clearRect(0,0,this.width,this.height),this.renderDisplayObject(e),e.interactive&&(e._interactiveEventsAdded||(e._interactiveEventsAdded=!0,e.interactionManager.setTarget(this)))},PIXI.CanvasRenderer.prototype.resize=function(e,t){this.width=e,this.height=t,this.view.width=e,this.view.height=t},PIXI.CanvasRenderer.prototype.renderDisplayObject=function(e){var t=e.worldTransform,n=this.context;n.globalCompositeOperation="source-over";var r=!1;if(!e.visible)return;if(e instanceof PIXI.Sprite){var i=e.texture.frame;i&&(n.globalAlpha=e.worldAlpha,r=!1,n.setTransform(t[0],t[3],t[1],t[4],t[2],t[5]),n.drawImage(e.texture.baseTexture.source,i.x,i.y,i.width,i.height,(e.anchor.x-e.texture.trim.x)*-i.width,(e.anchor.y-e.texture.trim.y)*-i.height,e.width,e.height
))}else e instanceof PIXI.Strip&&(n.setTransform(t[0],t[3],t[1],t[4],t[2],t[5]),this.renderStrip(e));for(var s=0;s<e.children.length;s++)this.renderDisplayObject(e.children[s])},PIXI.CanvasRenderer.prototype.renderStripFlat=function(e){var t=this.context,n=e.verticies,r=e.uvs,i=n.length/2;this.count++,t.beginPath();for(var s=1;s<i-2;s++){var o=s*2,u=n[o],a=n[o+2],f=n[o+4],l=n[o+1],c=n[o+3],h=n[o+5];t.moveTo(u,l),t.lineTo(a,c),t.lineTo(f,h)}t.fillStyle="#FF0000",t.fill(),t.closePath()},PIXI.CanvasRenderer.prototype.renderStrip=function(e){var t=this.context,n=e.verticies,r=e.uvs,i=n.length/2;this.count++;for(var s=1;s<i-2;s++){var o=s*2,u=n[o],a=n[o+2],f=n[o+4],l=n[o+1],c=n[o+3],h=n[o+5],p=r[o]*e.texture.width,d=r[o+2]*e.texture.width,v=r[o+4]*e.texture.width,m=r[o+1]*e.texture.height,g=r[o+3]*e.texture.height,y=r[o+5]*e.texture.height;t.save(),t.beginPath(),t.moveTo(u,l),t.lineTo(a,c),t.lineTo(f,h),t.closePath(),t.clip();var b=p*g+m*v+d*y-g*v-m*d-p*y,w=u*g+m*f+a*y-g*f-m*a-u*y,E=p*a+u*v+d*f-a*v-u*d-p*f,S=p*g*f+m*a*v+u*d*y-u*g*v-m*d*f-p*a*y,x=l*g+m*h+c*y-g*h-m*c-l*y,T=p*c+l*v+d*h-c*v-l*d-p*h,N=p*g*h+m*c*v+l*d*y-l*g*v-m*d*h-p*c*y;t.transform(w/b,x/b,E/b,T/b,S/b,N/b),t.drawImage(e.texture.baseTexture.source,0,0),t.restore()}},PIXI.Strip=function(e,t,n){PIXI.DisplayObjectContainer.call(this),this.texture=e,this.blendMode=PIXI.blendModes.NORMAL;try{this.uvs=new Float32Array([0,1,1,1,1,0,0,1]),this.verticies=new Float32Array([0,0,0,0,0,0,0,0,0]),this.colors=new Float32Array([1,1,1,1]),this.indices=new Uint16Array([0,1,2,3])}catch(r){this.uvs=[0,1,1,1,1,0,0,1],this.verticies=[0,0,0,0,0,0,0,0,0],this.colors=[1,1,1,1],this.indices=[0,1,2,3]}this.width=t,this.height=n,e.baseTexture.hasLoaded?(this.width=this.texture.frame.width,this.height=this.texture.frame.height,this.updateFrame=!0):(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},PIXI.Strip.constructor=PIXI.Strip,PIXI.Strip.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),PIXI.Strip.prototype.setTexture=function(e){this.texture=e,this.width=e.frame.width,this.height=e.frame.height,this.updateFrame=!0},PIXI.Strip.prototype.onTextureUpdate=function(e){this.updateFrame=!0},PIXI.Rope=function(e,t){PIXI.Strip.call(this,e),this.points=t;try{this.verticies=new Float32Array(t.length*4),this.uvs=new Float32Array(t.length*4),this.colors=new Float32Array(t.length*2),this.indices=new Uint16Array(t.length*2)}catch(n){this.verticies=verticies,this.uvs=uvs,this.colors=colors,this.indices=indices}this.refresh()},PIXI.Rope.constructor=PIXI.Rope,PIXI.Rope.prototype=Object.create(PIXI.Strip.prototype),PIXI.Rope.prototype.refresh=function(){var e=this.points;if(e.length<1)return;var t=this.uvs,n=this.indices,r=this.colors,i=e[0],s,o={x:0,y:0},u=e[0];this.count-=.2,t[0]=0,t[1]=1,t[2]=0,t[3]=1,r[0]=1,r[1]=1,n[0]=0,n[1]=1;var a=e.length;for(var f=1;f<a;f++){var u=e[f],l=f*4,c=f/(a-1);f%2?(t[l]=c,t[l+1]=0,t[l+2]=c,t[l+3]=1):(t[l]=c,t[l+1]=0,t[l+2]=c,t[l+3]=1),l=f*2,r[l]=1,r[l+1]=1,l=f*2,n[l]=l,n[l+1]=l+1,i=u}},PIXI.Rope.prototype.updateTransform=function(){var e=this.points;if(e.length<1)return;var t=this.verticies,n=e[0],r,i={x:0,y:0},s=e[0];this.count-=.2,t[0]=s.x+i.x,t[1]=s.y+i.y,t[2]=s.x-i.x,t[3]=s.y-i.y;var o=e.length;for(var u=1;u<o;u++){var s=e[u],a=u*4;u<e.length-1?r=e[u+1]:r=s,i.y=-(r.x-n.x),i.x=r.y-n.y;var f=(1-u/(o-1))*10;f>1&&(f=1);var l=Math.sqrt(i.x*i.x+i.y*i.y),c=this.texture.height/2;i.x/=l,i.y/=l,i.x*=c,i.y*=c,t[a]=s.x+i.x,t[a+1]=s.y+i.y,t[a+2]=s.x-i.x,t[a+3]=s.y-i.y,n=s}PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)},PIXI.Rope.prototype.setTexture=function(e){this.texture=e,this.updateFrame=!0},PIXI.BaseTextureCache={},PIXI.texturesToUpdate=[],PIXI.BaseTexture=function(e){PIXI.EventTarget.call(this),this.width=100,this.height=100,this.source=e;if(this.source instanceof Image)if(this.source.complete)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,PIXI.texturesToUpdate.push(this);else{var t=this;this.source.onload=function(){t.hasLoaded=!0,t.width=t.source.width,t.height=t.source.height,PIXI.texturesToUpdate.push(t),t.dispatchEvent({type:"loaded",content:t})}}else this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,PIXI.texturesToUpdate.push(this)},PIXI.BaseTexture.constructor=PIXI.BaseTexture,PIXI.BaseTexture.prototype.fromImage=function(e){},PIXI.TextureCache={},PIXI.FrameCache={},PIXI.Texture=function(e,t){PIXI.EventTarget.call(this),t||(this.noFrame=!0,t=new PIXI.Rectangle(0,0,1,1)),this.trim=new PIXI.Point,this.baseTexture=e,this.frame=t,this.scope=this;if(e.hasLoaded)this.noFrame&&(t=new PIXI.Rectangle(0,0,e.width,e.height)),this.setFrame(t);else{var n=this;e.addEventListener("loaded",function(){n.onBaseTextureLoaded()})}},PIXI.Texture.constructor=PIXI.Texture,PIXI.Texture.prototype.onBaseTextureLoaded=function(e){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new PIXI.Rectangle(0,0,t.width,t.height)),this.noFrame=!1,this.width=this.frame.width,this.height=this.frame.height,this.scope.dispatchEvent({type:"update",content:this})},PIXI.Texture.prototype.setFrame=function(e){this.frame=e,this.width=e.width,this.height=e.height;if(e.x+e.width>this.baseTexture.width||e.y+e.height>this.baseTexture.height)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this)},PIXI.Texture.fromImage=function(e,t){var n=PIXI.TextureCache[e];if(!n){var r=PIXI.BaseTextureCache[e];if(!r){var i=new Image;t&&(i.crossOrigin=""),i.src=e,r=new PIXI.BaseTexture(i),PIXI.BaseTextureCache[e]=r}n=new PIXI.Texture(r),PIXI.TextureCache[e]=n}return n},PIXI.Texture.fromFrame=function(e){var t=PIXI.TextureCache[e];if(!t)throw new Error("The frameId '"+e+"' does not exist in the texture cache "+this);return t},PIXI.Texture.fromCanvas=function(e){var t=PIXI.TextureCache[e];if(!t){var n=PIXI.BaseTextureCache[e];n||(n=new PIXI.BaseTexture(e),PIXI.BaseTextureCache[e]=n),t=new PIXI.Texture(n),PIXI.TextureCache[e]=t}return t},PIXI.Texture.addTextureToCache=function(e,t){PIXI.TextureCache[t]=e},PIXI.Texture.removeTextureFromCache=function(e){var t=PIXI.TextureCache[e];return PIXI.TextureCache[e]=null,t},PIXI.SpriteSheetLoader=function(e){PIXI.EventTarget.call(this),this.url=e,this.baseUrl=e.replace(/[^\/]*$/,""),this.texture,this.frames={},this.crossorigin=!1},PIXI.SpriteSheetLoader.constructor=PIXI.SpriteSheetLoader,PIXI.SpriteSheetLoader.prototype.load=function(){this.ajaxRequest=new AjaxRequest;var e=this;this.ajaxRequest.onreadystatechange=function(){e.onLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},PIXI.SpriteSheetLoader.prototype.onLoaded=function(){if(this.ajaxRequest.readyState==4)if(this.ajaxRequest.status==200||window.location.href.indexOf("http")==-1){var jsondata=eval("("+this.ajaxRequest.responseText+")"),textureUrl=this.baseUrl+jsondata.meta.image;this.texture=PIXI.Texture.fromImage(textureUrl,this.crossorigin).baseTexture;var frameData=jsondata.frames;for(var i in frameData){var rect=frameData[i].frame;PIXI.TextureCache[i]=new PIXI.Texture(this.texture,{x:rect.x,y:rect.y,width:rect.w,height:rect.h}),frameData[i].trimmed&&(PIXI.TextureCache[i].realSize=frameData[i].spriteSourceSize,PIXI.TextureCache[i].trim.x=0)}if(this.texture.hasLoaded)this.dispatchEvent({type:"loaded",content:this});else{var scope=this;this.texture.addEventListener("loaded",function(){scope.dispatchEvent({type:"loaded",content:scope})})}}},PIXI.AssetLoader=function(e){PIXI.EventTarget.call(this),this.assetURLs=e,this.assets=[],this.crossorigin=!1},PIXI.AssetLoader.constructor=PIXI.AssetLoader,PIXI.AssetLoader.prototype.load=function(){this.loadCount=this.assetURLs.length;var e=["jpeg","jpg","png","gif"],t=["json"];for(var n=0;n<this.assetURLs.length;n++){var r=this.assetURLs[n],i=r.split(".").pop().toLowerCase(),s=null;for(var o=0;o<e.length;o++)if(i==e[o]){s="img";break}if(s!="img")for(var o=0;o<t.length;o++)if(i==t[o]){s="atlas";break}if(s=="img"){var u=PIXI.Texture.fromImage(r,this.crossorigin);if(!u.baseTexture.hasLoaded){var a=this;u.baseTexture.addEventListener("loaded",function(e){a.onAssetLoaded()}),this.assets.push(u)}else this.loadCount--,this.loadCount==0&&(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())}else{if(s!="atlas")throw new Error(r+" is an unsupported file type "+this);var f=new PIXI.SpriteSheetLoader(r);f.crossorigin=this.crossorigin,this.assets.push(f);var a=this;f.addEventListener("loaded",function(e){a.onAssetLoaded()}),f.load()}}},PIXI.AssetLoader.prototype.onAssetLoaded=function(){this.loadCount--,this.dispatchEvent({type:"onProgress",content:this}),this.onProgress&&this.onProgress(),this.loadCount==0&&(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())};